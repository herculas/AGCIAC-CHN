\tikzset{every picture/.style={line width=0.75pt}} 

\begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1]


\draw  [draw opacity=0][fill={rgb, 255:red, 155; green, 155; blue, 155 }  ,fill opacity=0.6 ] (95,60) -- (240,20) -- (300,20) -- (445,60) -- cycle ;

\draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ][line width=1.2] [general shadow={fill=black,shadow xshift=2.25pt,shadow yshift=-2.25pt}] (60,150) -- (120,150) -- (120,210) -- (60,210) -- cycle ;
\draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ][line width=1.2] [general shadow={fill=black,shadow xshift=2.25pt,shadow yshift=-2.25pt}] (160,150) -- (220,150) -- (220,210) -- (160,210) -- cycle ;
\draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ][line width=1.2] [general shadow={fill=black,shadow xshift=2.25pt,shadow yshift=-2.25pt}] (260,150) -- (320,150) -- (320,210) -- (260,210) -- cycle ;
\draw  [fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ][line width=1.2] [general shadow={fill=black,shadow xshift=2.25pt,shadow yshift=-2.25pt}] (420,150) -- (480,150) -- (480,210) -- (420,210) -- cycle ;

\draw  [line width=1.2]  (0,150) -- (20,150) -- (20,210) -- (0,210) -- cycle ;
\draw  [line width=1.2]  (520,150) -- (540,150) -- (540,210) -- (520,210) -- cycle ;
\draw  [line width=1.2]  (95,60) -- (445,60) -- (445,80) -- (95,80) -- cycle ;
\draw  [line width=1.2]  (240,0) -- (300,0) -- (300,20) -- (240,20) -- cycle ;

\draw [line width=1.2]    (165,60) -- (165,80) ;
\draw [line width=1.2]    (235,60) -- (235,80) ;
\draw [line width=1.2]    (305,60) -- (305,80) ;
\draw [line width=1.2]    (375,60) -- (375,80) ;
\draw [line width=1.2]    (240,20) -- (95,60) ;
\draw [line width=1.2]    (300,20) -- (445,60) ;

\draw  [->]  (130,80) -- (90,115) -- (90,149) ;
\draw  [->]  (200,80) -- (190,115) -- (190,149) ;
\draw  [->]  (270,80) -- (290,115) -- (290,149) ;
\draw  [->]  (410,80) -- (450,115) -- (450,149) ;

\draw  [->]  (20,180) -- (59,180) ;
\draw  [->]  (120,180) -- (159,180) ;
\draw  [->]  (220,180) -- (259,180) ;
\draw  [->]  (320,180) -- (419,180) ;
\draw  [->]  (480,180) -- (519,180) ;

\draw   (50,230) -- (130,230) ;
\draw   (150,230) -- (230,230) ;
\draw   (250,230) -- (330,230) ;
\draw   (410,230) -- (490,230) ;

% mask for cdots
\draw  [draw opacity=0][fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (355,170) -- (385,170) -- (385,190) -- (355,190) -- cycle ;

\draw [shift={(130,230)}, rotate = 180] [color={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.75]    (0,4.47) -- (0,-4.47)   ;
\draw [shift={(50,230)}, rotate = 180] [color={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.75]    (0,4.47) -- (0,-4.47)   ;
\draw [shift={(230,230)}, rotate = 180] [color={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.75]    (0,4.47) -- (0,-4.47)   ;
\draw [shift={(150,230)}, rotate = 180] [color={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.75]    (0,4.47) -- (0,-4.47)   ;
\draw [shift={(330,230)}, rotate = 180] [color={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.75]    (0,4.47) -- (0,-4.47)   ;
\draw [shift={(250,230)}, rotate = 180] [color={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.75]    (0,4.47) -- (0,-4.47)   ;
\draw [shift={(490,230)}, rotate = 180] [color={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.75]    (0,4.47) -- (0,-4.47)   ;
\draw [shift={(410,230)}, rotate = 180] [color={rgb, 255:red, 0; green, 0; blue, 0 }  ][line width=0.75]    (0,4.47) -- (0,-4.47)   ;

\draw  [draw opacity=0][fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (65,220) -- (115,220) -- (115,240) -- (65,240) -- cycle ;
\draw  [draw opacity=0][fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (165,220) -- (215,220) -- (215,240) -- (165,240) -- cycle ;
\draw  [draw opacity=0][fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (265,220) -- (315,220) -- (315,240) -- (265,240) -- cycle ;
\draw  [draw opacity=0][fill={rgb, 255:red, 255; green, 255; blue, 255 }  ,fill opacity=1 ] (425,220) -- (475,220) -- (475,240) -- (425,240) -- cycle ;


\draw (10,180) node    {$x$};
\draw (530,180) node    {$y$};
\draw (90,180) node    {$\hat{E}$};
\draw (190,180) node    {$\hat{E}$};
\draw (290,180) node    {$\hat{E}$};
\draw (450,180) node    {$\hat{E}$};
\draw (130,70) node    {$k_{1}$};
\draw (200,70) node    {$k_{2}$};
\draw (270,70) node    {$k_{3}$};
\draw (340,70) node    {$\cdots $};
\draw (410,70) node    {$k_{n}$};
\draw (270,10) node    {$k$};
\draw (270,40) node   [align=left] {\textbf{密钥扩展}};
\draw (370,180) node    {$\cdots $};
\draw (90,230) node   [align=left] {\small 第 $1$ 轮};
\draw (190,230) node   [align=left] {\small 第 $2$ 轮};
\draw (290,230) node   [align=left] {\small 第 $3$ 轮};
\draw (450,230) node   [align=left] {\small 第 $n$ 轮};


\end{tikzpicture}