\section{椭圆曲线上的点群}\label{sec:15-1}

椭圆曲线在数学的几个分支中都有出现。在这里，我们主要关注它们作为算术（对有理数的研究）这一分支的发展。我们的故事从丢潘图 (Diophantus) 开始，他是公元 3 世纪生活在亚历山大的希腊数学家。丢潘图对以下问题感兴趣：给定一个二元多项式方程 $f(x,y)=0$，找到满足该方程的有理点。所谓有理点指的是两个坐标都是有理数的点，比如 $({1}/{2},{1}/{3})$ 是一个有理点，但 $(1,\sqrt{2})$ 就不是。丢番图就这一问题写了一系列有影响的书，称为\emph{《算术》(Arithmetica)}，其中有六卷有幸保存至今。14 个世纪后，费马 (Fermat) 在《算术》拉丁文译本的空白处写下了他著名的猜想。Bashmakova 的一本颇有见地的小册子用现代数学的语言描述了丢番图的思想。

《算术》的大部分内容都是在研究一元二次方程的整数解和有理解。然而，在少数地方，丢番图考虑了更高层次的问题。在第 4 卷的问题 24 中，椭圆曲线首次出现，它研究的是一个三次方程。该问题等价于以下问题：找到满足方程：
\begin{equation}\label{eq:15-1}
y^2=x^3-x+9
\end{equation}
的有理点 $(x,y)\in\mathbb{Q}^2$。图 \ref{fig:15-1} 展示了这条曲线在实数域上的分布情况。我们不知道是什么迫使丢番图提出这个问题，但可以想见，如果他知道他发明的方法在十几个世纪之后被广泛用于保护全世界数十亿人的互联网流量，他一定会倍感震惊。

我们很容易验证六个整数点 $(0,\pm3)$，$(1,\pm3)$，$(-1,\pm3)$ 都在式 \ref{eq:15-1} 的曲线上。但是，丢番图想在这条曲线上找到更多的有理点。

他开始从已有的六个点中派生出新的有理点。下面是一种方法，但与丢番图的做法稍有不同。令 $P:=(-1,-3)$，$Q:=(1,3)$，这两个点显然都满足式 \ref{eq:15-1}。让我们看一下经过 $P$ 和 $Q$ 的直线，如图 \ref{fig:15-1-b} 所示。我们很容易验证这条直线就是 $y=3x$，而且它必然与曲线 $y^2=x^3-x+9$ 恰好有三个交点。想要知道为什么，可以观察到，如果我们用 $3x$ 代换式 \ref{eq:15-1} 中的 $y$，就能够得到一个单变量的三次方程 $(3x)^2=x^3-x+9$。我们现在已经知道了这个三次方程的两个有理根，即$P$ 点对应的 $x_1=-1$ 和 $Q$ 点对应的 $x_2=1$。不难知道，有两个有理系数的三次方程在已有两个有理根的情况下，也一定能找到第三个有理根 $x_3$。在我们的例子中，这第三个有理根恰好是 $x_3=9$。设置 $y_3=3x_3$，我们就得到曲线 \ref{eq:15-1} 上的一个新点，即 $(9,27)$。我们暂且用 $-R$ 来表示这个点，原因我们将会马上说明。同时，我们也能立即得到另一个点 $(9,-27)$，我们将其记为 $R$。更一般地，对于曲线上的一个点 $T=(x,y)$，我们记 $-T:=(x,-y)$。

这种建立有理点的技术被称为\textbf{割弦法 (chord method)}。这种方法非常普适：给定曲线上两个不同的有理点 $U$ 和 $V$，其中 $U\neq-V$，我们就可以构造一条穿过这两点的直线，而这条直线必然与曲线交于第三个有理点 $-W$。例如，对上面的点 $P$ 和 $R$ 应用这种方法，我们就可以得到两个新的点 $(-56/25,3/125)$ 和 $(-56/25,-3/125)$。

几个世纪以来，割弦法被重新发现了好几次，但它最终被庞加莱 (Poincaré) 在代数曲线上的工作确定下来。庞加莱把从两个已知的有理点构建一个新的有理点的过程比作是一个群中的加法运算。具体来说，对于曲线上的不同点 $U$ 和 $V$，其中 $U\neq-V$，令 $-W$ 是曲线上的另一个点，该点与 $U$ 和 $V$ 共线，是直线与曲线的第三个交点。然后，庞加莱将 $U$ 与 $V$ 的加法表示为 $U\boxplus V$，有：
\begin{equation}\label{eq:15-2}
U\boxplus V=-W
\end{equation}
图 \ref{fig:15-1-b} 展示了在点 $P$ 和 $Q$ 上应用这一加法规则的结果。它们的和 $P\boxplus Q$ 就是点 $R=(9,27)$。使用式 \ref{eq:15-2} 的方法定义加法，当定义的方式比较妥当时，这个操作就具有结合性。回顾一下，结核性意味着 $(U\boxplus V)\boxplus W=U\boxplus(V\boxplus W)$。


\begin{figure}
  \centering
  \subfigure[曲线]{
    \input{figures/chapter15/fig1-a.tex}
    \label{fig:15-1-a}
  }
  \quad\quad\quad\quad
  \subfigure[添加点 $P=(-1,-3)$ 和点 $Q=(1,3)$]{
    \input{figures/chapter15/fig1-b.tex}
    \label{fig:15-1-b}
  }
  \caption{实数域上的曲线 $y^2=x^3-x+9$}
  \label{fig:15-1}
\end{figure}

我们将在下一节展示如何加强这个加法规则，使得曲线上的点集能够构成一个群。数论中一些最优雅的结论，以及一些深刻的开放性问题，都来自于试图理解椭圆曲线上的有理点群的特性。

我们再说回丢番图，他在式 \ref{eq:15-1} 上寻找有理点的方法是我们刚才介绍的方法的一个变体。丢番图没有选择过两个不同的点的直线，而是选择了在其中一个已知点上作一条该曲线的切线。假设我们在点 $P=(-1,-3)$ 上作一条曲线的切线。和之前一样，不难证明，在有理系数的三次曲线上，如果 $(x_1,y_1)$ 是一个有理点，且 $y_1\neq0$，那么曲线在 $(x_1,y_1)$ 处的切线一定与曲线相交于另一个点 $T$，且 $T$ 也必然是一个有理点。在我们的例子中，曲线在 $P=(-1,-3)$ 处的切线是 $y=-{1/3}x-{10/3}$，该直线与曲线的另一个交点是 $({19/9},-{109/27})$，该点确实是一个有理点。这种方法被称为\textbf{切线法 (tangent method)}，它是在 $y_1\neq0$时从一个给定的有理点 $(x_1,y_1)$ 建立一个新有理点的另一种方法。正如我们将看到的，它相当于将点 $P$ 与自己相加，即计算 $P\boxplus P$。